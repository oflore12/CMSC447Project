{% extends 'base.html' %}
{% import 'search_bar.html' as search_bar %}

{% block title %}Search{% endblock %}

{% block content %}
{{ search_bar.mainSearchBar(q, provider) }}

{% for r in results %}
<div class="searchResults">
	<h4>{{r.title}}</h4>

	<div class="provTray">
		{% if r.providers.get(country).buy %}
		<div class="provRow">
			<div class="provColumn vertical" style="background: rgba(0,0,0,1)">BUY</div>
			<div class="provColumn icons">
				{% for b in r.providers.get(country).buy %}
				<div class="iconContainer">
					{% set imageUrl = "https://image.tmdb.org/t/p/w500/" + b.logo_path %}
					<img src="{{imageUrl}}" alt="streaming service logo" width="75" height="75" onload="this.classList.add('loadedImg')" />
					<!--<span>{{b.provider_name}}</span>-->
				</div>
				{% endfor %}
			</div>
		</div>
		{% endif %}

		{% if r.providers.get(country).flatrate %}
		<div class="provRow">
			<div class="provColumn vertical" style="background: rgba(0,0,0,0.7)">STREAM</div>
			<div class="provColumn icons">
				{% for f in r.providers.get(country).flatrate %}
				<div class="iconContainer">
					{% set imageUrl = "https://image.tmdb.org/t/p/w500/" + f.logo_path %}
					<img src="{{imageUrl}}" alt="streaming service logo" width="75" height="75" onload="this.classList.add('loadedImg')" />
					<!--<<span>{{f.provider_name}}</span>-->
				</div>
				{% endfor %}
			</div>
		</div>
		{% endif %}

		{% if r.providers.get(country).rent %}
		<div class="provRow">
			<div class="provColumn vertical" style="background: rgba(0,0,0,0.45)">RENT</div>
			<div class="provColumn icons">
				{% for p in r.providers.get(country).rent %}
				<div class="iconContainer">
					{% set imageUrl = "https://image.tmdb.org/t/p/w500/" + p.logo_path %}
					<img src="{{imageUrl}}" alt="streaming service logo" width="75" height="75" onload="this.classList.add('loadedImg')" />
					<!--<<span>{{p.provider_name}}</span>-->
				</div>
				{% endfor %}
			</div>
		</div>
		{% endif %}

		{% if r.providers.get(country).free %}
		<div class="provRow">
			<div class="provColumn vertical" style="background: rgba(0,0,0,0.25); color: black">FREE</div>
			<div class="provColumn icons">
				{% for f in r.providers.get(country).free %}
				<div class="iconContainer">
					{% set imageUrl = "https://image.tmdb.org/t/p/w500/" + f.logo_path %}
					<img src="{{imageUrl}}" alt="streaming service logo" width="75" height="75" onload="this.classList.add('loadedImg')" />
					<!--<<span>{{f.provider_name}}</span>-->
				</div>
				{% endfor %}
			</div>
		</div>
		{% endif %}

		{% if r.providers.get(country).ads %}
		<div class="provRow">
			<div class="provColumn vertical" style="background: rgba(0,0,0,0.1); color: black">ADS</div>
			<div class="provColumn icons">
				{% for a in r.providers.get(country).ads %}
				<div class="iconContainer">
					{% set imageUrl = "https://image.tmdb.org/t/p/w500/" + a.logo_path %}
					<img src="{{imageUrl}}" alt="streaming service logo" width="75" height="75" onload="this.classList.add('loadedImg')" />
					<!--<<span>{{a.provider_name}}</span>-->
				</div>
				{% endfor %}
			</div>
		</div>
		{% endif %}
	</div>

	{% if not r.providers.get(country) %}
	<p class="notAvailableMsg">Not available from any streaming providers</p>
	{% endif %}
</div>
{% endfor %}
{% endblock %}