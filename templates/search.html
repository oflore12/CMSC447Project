{% extends 'base.html' %}
{% import 'search_bar.html' as search_bar %}

{% block title %}Search{% endblock %}

{% block content %}
{{ search_bar.mainSearchBar(q, provider) }}

{% for r in results %}
<div style="margin-bottom: 50px">
	<h4>{{r.title}}</h4>

	{% if r.providers.get(country).buy %}
	<p>Available to buy on:</p>
	<ul>
		{% for b in r.providers.get(country).buy %}
		<li>
			{% set imageUrl = "https://image.tmdb.org/t/p/w500/" + b.logo_path %}
			<img src="{{imageUrl}}" alt="streaming service logo" width="50" height="50" />
			{{b.provider_name}}
		</li>
		{% endfor %}
	</ul>
	{% endif %}

	{% if r.providers.get(country).flatrate %}
	<p>Available to stream on subscription services:</p>
	<ul>
		{% for f in r.providers.get(country).flatrate %}
		<li>
			{% set imageUrl = "https://image.tmdb.org/t/p/w500/" + f.logo_path %}
			<img src="{{imageUrl}}" alt="streaming service logo" width="50" height="50" />
			{{f.provider_name}}
		</li>
		{% endfor %}
	</ul>
	{% endif %}

	{% if r.providers.get(country).rent %}
	<p>Available to rent on:</p>
	<ul>
		{% for p in r.providers.get(country).rent %}
		<li>
			{% set imageUrl = "https://image.tmdb.org/t/p/w500/" + p.logo_path %}
			<img src="{{imageUrl}}" alt="streaming service logo" width="50" height="50" />
			{{p.provider_name}}
		</li>
		{% endfor %}
	</ul>
	{% endif %}

	{% if r.providers.get(country).free %}
	<p>Available for free on:</p>
	<ul>
		{% for f in r.providers.get(country).free %}
		<li>
			{% set imageUrl = "https://image.tmdb.org/t/p/w500/" + f.logo_path %}
			<img src="{{imageUrl}}" alt="streaming service logo" width="50" height="50" />
			{{f.provider_name}}
		</li>
		{% endfor %}
	</ul>
	{% endif %}

	{% if r.providers.get(country).ads %}
	<p>Available with ads on:</p>
	<ul>
		{% for a in r.providers.get(country).ads %}
		<li>
			{% set imageUrl = "https://image.tmdb.org/t/p/w500/" + a.logo_path %}
			<img src="{{imageUrl}}" alt="streaming service logo" width="50" height="50" />
			{{a.provider_name}}
		</li>
		{% endfor %}
	</ul>
	{% endif %}

	{% if not r.providers.get(country) %}
	Not available from any streaming providers
	{% endif %}
</div>
{% endfor %}
{% endblock %}